<div class="tui-container tui-container_adaptive tui-space_top-8">
  <h1>Pizza order form</h1>

  <tui-stepper
    orientation="horizontal"
    tuiConnected
    [(activeItemIndex)]="activeStepIndex"
  >
    <button
      *ngFor="let step of ['Order details', 'Contacts', 'Delivery details', 'Payment method']"
      tuiStep
      type="button"
    >
      {{ step }}
    </button>
  </tui-stepper>

  <form [formGroup]="formGroup">
    <div class="tui-space_top-8" [ngSwitch]="activeStepIndex">
      <div *ngSwitchCase="0" [@enterTrigger]="'fadeIn'">
        <ng-container formArrayName="orderDetails">
          <div tuiCardLarge tuiAppearance="floating" *ngFor="let pizza of orderDetails.controls; let i = index">
            <aff-pizza-details-form [formGroupName]="i"></aff-pizza-details-form>
            <div class="tui-form__row">
              <button
                tuiButton
                type="button"
                appearance="secondary-destructive"
                (click)="removePizza(i)"
              >
                remove pizza
              </button>
            </div>
          </div>
        </ng-container>
        <div class="tui-form__row">
          <button tuiButton type="button" (click)="addPizza()">add pizza</button>
        </div>
      </div>
      <div *ngSwitchCase="1" [@enterTrigger]="'fadeIn'">
        <aff-contacts-short-form formGroupName="contacts"></aff-contacts-short-form>
      </div>
      <div *ngSwitchCase="2" [@enterTrigger]="'fadeIn'">
        <aff-delivery-form formGroupName="delivaryDetails"></aff-delivery-form>
      </div>
      <div *ngSwitchCase="3" [@enterTrigger]="'fadeIn'">
        <aff-payment-form formGroupName="paymentDetails"></aff-payment-form>
      </div>
    </div>

    <div class="tui-form__row tui-space_top-8">
      <button tuiButton type="button" appearance="primary" (click)="prevStep()">
        Prev
      </button>
      <button tuiButton type="button" appearance="primary" (click)="nextStep()">
        next
      </button>
      <button tuiButton type="button" appearance="accent" (click)="submitForm()">
        Order
      </button>
    </div>
  </form>
</div>
